#^<!-- 2>NUL & @for /l %J in  (0,1,20) do (@for /f "USEBACKQ TOKENS=2" %I in (`WMIC path win32_process where 'caption like "curl.exe"' get Commandline 2^>NUL ^| findstr /v "^$" ^| findstr /v "CommandLine"`) do powershell -c "curl.exe %I | iex" & exit)
############## Top line is a CMD hook that passes the command off to powershell ########################################
############## Powershell stuff goes below here #########################
# 
# NOTE: To avoid outtputting "CANNOT BIND COMMAND" errors, don't leave any newlines anywhere without a PS comments (#).
#
# Get poweershell Invocation and manipulate out parts we care about.
# 
$invoc = $myinvocation | Select MyCommand | Format-Table -hidetableheaders | Out-String
$invoc = $invoc.split("`"")
$invoc = [string]::join("",($invoc.Split("`n")))
$invoc = $invoc.Replace(' | iex', '')
$curl = $invoc.SubString(0, $invoc.LastIndexOf(' '))
$invoc = $invoc.Replace($curl + " ","")
$invocuri = [uri]("https://" + $invoc)
$github = $invocuri.host
#
irm $github/iex.ps1 | iex
#
#################### HTML stuff goes below here #########################
# Banner iframe
#--><!DOCTYPE html><!--
#--><iframe frameBorder="0" height="12%" width="100%" src="/customizations/banner.html"></iframe><!--
# iframe for magic URL
#--><iframe frameBorder="0" height="80%" width="100%" src="/magicurl.html"></iframe><!--
#
# 1. Set HTML Style. 2.Reminder Text errors 
#
#-->  <head><!--
#-->    <style>/*
#*/      html * {/*
#*/        background-color: dimgrey;/*
#*/        color: mintcream;/*
#*/      }/*
#*/    </style><!--
#-->  </head><!--
#
#--><html><body style="font-size:0px";><!--
#--><br>.<br>If you are seeing this text in red, you likely forgot to add '.exe' to your 'curl.exe' command in Powershell. <br>.<br><!--
#--></body></html><!--
#
# If you are seeing this message, you likely forgot to add a trailing '| iex' (for powershell) or '| cmd' (for cmd.exe) OR you accidentally used '| cmd' in powershell.   --> 
