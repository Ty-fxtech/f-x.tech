### iex.run ### <br> <br> <!-- & powershell
############## Powershell stuff goes below here #########################
# 
# To avoid PS errors, don't leave any newlines without preceding ps comments (#).
#
### Config:
#
$githubURL = "https://github.com/Xyvir/iex.run" # Required
$predownloadLocation = '$Env:Public\$github\'
$autocomplete = $true # Default is $true
$DebugVars = $true #show all vars created, default $false
#
### Init:
#
$old = $ProgressPreference
$ProgressPreference = "SilentlyContinue"
$github = ([uri]$githubURL).Segments | Select -Last 1
$cmd = $myinvocation | Select MyCommand | Format-Table -hidetableheaders | Out-String
$cmd = [string]::join("",($cmd.Split("`n")))
$cmd = $cmd -Split " " | Select -Index 1
$cmduri = [uri]("https://" + $cmd)
$fileURLs = (wget $githubURL).Links | Where-Object {$_.href -like "*blob*"} | Select -ExpandProperty href
$downloadcmd = '$downloadlocation' + "= `"$predownloadLocation`""
iex $downloadcmd
#
### Execute:
#
if ($DebugVars) {get-variable | where-object {(@("FormatEnumerationLimit", "MaximumAliasCount", "MaximumDriveCount", "MaximumErrorCount", "MaximumFunctionCount", "MaximumVariableCount", "PGHome", "PGSE", "PGUICulture", "PGVersionTable", "PROFILE", "PSSessionOption") -notcontains $_.name) -and (([psobject].Assembly.GetType('System.Management.Automation.SpecialVariables').GetFields('NonPublic,Static') | Where-Object FieldType -eq ([string]) | ForEach-Object GetValue $null)) -notcontains $_.name}}
Write-Output ""
Write-Output "iex.run Complete!"
Write-Output ""
#
### Cleanup:
#
$ProgressPreference = $old
#
#################### HTML stuff goes below here #########################
# Let the insane cross-commenting begin.
#--><!DOCTYPE html><!--
#--><html><body><!--
#--><div style = "margin-left:25%"><!--
#--><p>1. Click the 'Copy' button below.</p><!--
#--><button onclick="myFunction()">Copy</button><!--
#--><input type="text" value="powershell -noexit -c curl.exe" id="myInput" size="50" readonly=""><!--
#--><p>2. Press Winkey and 'R' together. ( &#x229E  + R ) NOTE: Windows key is located between CTRL and ALT. </p><!--
#--><p>3. Paste. (CTRL +V)</p><!--
#--><p>4. Press Enter.</p><!--
#--><p>5. If prompted, click 'Yes' on the 'Do you want to allow this app...' pop-up. </p><!--
#--><p>6. Please wait until you see the message 'iex.run Complete!' </p><!--
#--><p>NOTE: If anything goes wrong, or you are still having issues, please inform your IT department. </p><!--
#--><p id="demo"></p><!--
#--></div><!--
#--><script>/*
#*/function myFunction() {/*
#*/  var copyText = document.getElementById("myInput");/*
#*/  copyText.select();/*
#*/ copyText.setSelectionRange(0, 99999)/*
#*/  document.execCommand("copy");/*
#*/}/*
#*/document.getElementById("myInput").value = /*
#*/"powershell -noexit -c curl.exe " + window.location.hostname + window.location.pathname + " | iex";/*
#*/</script><!--
#--></body></html>
